<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Population Globe</title>
<style>
  body { margin: 0; overflow: hidden; background: #000; font-family: Arial, sans-serif; }
  canvas { display: block; }

  #cityList {
    position: absolute;
    top: 10px;
    right: 10px;
    width: 260px;
    max-height: 90vh;
    overflow-y: auto;
    background: rgba(0,0,0,0.7);
    color: #fff;
    padding: 10px;
    font-size: 12px;
    border-radius: 8px;
  }
</style>
</head>
<body>

<div id="cityList">
  <h3>Top Cities</h3>
  <ul id="list"></ul>
</div>

<script type="module">
import * as THREE from "https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.module.js";

const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.z = 3;

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const radius = 1;

/* ===============================
   EARTH TEXTURE BACKGROUND LAYER
=============================== */

const loader = new THREE.TextureLoader();
const earthTexture = loader.load(
  "https://threejs.org/examples/textures/land_ocean_ice_cloud_2048.jpg",
  () => init()
);

function init() {

  const earthPointCount = 12000; // sufficient density
  const earthPositions = [];
  const earthColors = [];

  const canvas = document.createElement("canvas");
  const ctx = canvas.getContext("2d");
  canvas.width = earthTexture.image.width;
  canvas.height = earthTexture.image.height;
  ctx.drawImage(earthTexture.image, 0, 0);

  const imageData = ctx.getImageData(0,0,canvas.width,canvas.height).data;

  for (let i = 0; i < earthPointCount; i++) {

    const u = Math.random();
    const v = Math.random();

    const theta = 2*Math.PI*u;
    const phi = Math.acos(2*v - 1);

    const x = radius*Math.sin(phi)*Math.cos(theta);
    const y = radius*Math.cos(phi);
    const z = radius*Math.sin(phi)*Math.sin(theta);

    earthPositions.push(x,y,z);

    const lon = Math.atan2(z,x);
    const lat = Math.asin(y/radius);

    const uTex = (lon/(2*Math.PI)) + 0.5;
    const vTex = 0.5 - (lat/Math.PI);

    const px = Math.floor(uTex*canvas.width);
    const py = Math.floor(vTex*canvas.height);

    const idx = (py*canvas.width + px)*4;

    const r = imageData[idx];
    const g = imageData[idx+1];
    const b = imageData[idx+2];

    const brightness = (r+g+b)/3;

    if (brightness > 120) {
      earthColors.push(1,1,1); // land = white
    } else {
      earthColors.push(0.35,0.35,0.35); // ocean = grey
    }
  }

  const earthGeo = new THREE.BufferGeometry();
  earthGeo.setAttribute("position", new THREE.Float32BufferAttribute(earthPositions,3));
  earthGeo.setAttribute("color", new THREE.Float32BufferAttribute(earthColors,3));

  const earthMaterial = new THREE.PointsMaterial({
    size: 0.0028, // 20% smaller than smallest city point (~0.0035)
    vertexColors: true,
    transparent: true,
    depthWrite: false
  });

  const earthPoints = new THREE.Points(earthGeo, earthMaterial);
  scene.add(earthPoints);

  /* ===============================
     CITY LAYER
  =============================== */

  const baseSize = 0.08 * 2; // +10% increase
  const minSize = baseSize * 5;

const cities = [

    ["Tokyo", 35.6895, 139.6917, 37.4],
    ["Delhi", 28.6139, 77.2090, 32.9],
    ["Shanghai", 31.2304, 121.4737, 29.2],
    ["Dhaka", 23.8103, 90.4125, 23.2],
    ["São Paulo", -23.5505, -46.6333, 22.6],
    ["Mexico City", 19.4326, -99.1332, 22.1],
    ["Mumbai", 19.0760, 72.8777, 22.0],
    ["Beijing", 39.9042, 116.4074, 21.8],
    ["Cairo", 30.0444, 31.2357, 21.3],
    ["Osaka", 34.6937, 135.5023, 19.3],
    ["New York", 40.7128, -74.0060, 19.0],
    ["Karachi", 24.8607, 67.0011, 17.2],
    ["Chongqing", 29.5630, 106.5516, 17.0],
    ["Istanbul", 41.0082, 28.9784, 15.6],
    ["Kinshasa", -4.4419, 15.2663, 15.6],
    ["Buenos Aires", -34.6037, -58.3816, 15.5],
    ["Lagos", 6.5244, 3.3792, 15.4],
    ["Kolkata", 22.5726, 88.3639, 15.0],
    ["Manila", 14.5995, 120.9842, 14.9],
    ["Rio de Janeiro", -22.9068, -43.1729, 13.7],
    ["Los Angeles", 34.0522, -118.2437, 13.2],
    ["Guangzhou", 23.1291, 113.2644, 13.5],
    ["Shenzhen", 22.5431, 114.0579, 12.5],
    ["Moscow", 55.7558, 37.6173, 12.6],
    ["Tianjin", 39.3434, 117.3616, 11.6],
    ["Jakarta", -6.2088, 106.8456, 11.3],
    ["Bangkok", 13.7563, 100.5018, 11.2],
    ["Lima", -12.0464, -77.0428, 11.2],
    ["Paris", 48.8566, 2.3522, 11.1],
    ["London", 51.5074, -0.1278, 10.8],
    ["Bangalore", 12.9716, 77.5946, 10.8],
    ["Chennai", 13.0827, 80.2707, 10.9],
    ["Bogotá", 4.7110, -74.0721, 10.7],
    ["Hyderabad", 17.3850, 78.4867, 10.4],
    ["Seoul", 37.5665, 126.9780, 9.9],
    ["Nagoya", 35.1815, 136.9066, 9.6],
    ["Tehran", 35.6892, 51.3890, 9.5],
    ["Chicago", 41.8781, -87.6298, 9.4],
    ["Ho Chi Minh City", 10.8231, 106.6297, 9.3],
    ["Ahmedabad", 23.0225, 72.5714, 8.7],
    ["Kuala Lumpur", 3.1390, 101.6869, 8.8],
    ["Hong Kong", 22.3193, 114.1694, 7.5],
    ["Toronto", 43.6532, -79.3832, 6.7],
    ["Madrid", 40.4168, -3.7038, 6.7],
    ["Johannesburg", -26.2041, 28.0473, 6.4],
    ["Washington DC", 38.9072, -77.0369, 6.4],
    ["Singapore", 1.3521, 103.8198, 5.9],
    ["Barcelona", 41.3851, 2.1734, 5.6],
    ["Sydney", -33.8688, 151.2093, 5.3],
    ["Nairobi", -1.2921, 36.8219, 5.3],
    ["Melbourne", -37.8136, 144.9631, 5.1],
    ["Phoenix", 33.4484, -112.0740, 4.9],
    ["Houston", 29.7604, -95.3698, 7.3],
    ["Dallas", 32.7767, -96.7970, 7.6],
    ["Miami", 25.7617, -80.1918, 6.2],
    ["Boston", 42.3601, -71.0589, 4.8],
    ["San Francisco", 37.7749, -122.4194, 4.7],
    ["Seattle", 47.6062, -122.3321, 4.1],
    ["Denver", 39.7392, -104.9903, 3.0],
    ["San Diego", 32.7157, -117.1611, 3.3],
    ["Philadelphia", 39.9526, -75.1652, 6.2],
    ["Atlanta", 33.7490, -84.3880, 6.0],

    ["Detroit", 42.3314, -83.0458, 4.3],
    ["Minneapolis", 44.9778, -93.2650, 3.7],
    ["Montreal", 45.5017, -73.5673, 4.1],
    ["Vancouver", 49.2827, -123.1207, 2.6],
    ["Rome", 41.9028, 12.4964, 4.3],
    ["Berlin", 52.5200, 13.4050, 3.8],
    ["Vienna", 48.2082, 16.3738, 2.6],
    ["Prague", 50.0755, 14.4378, 2.7],
    ["Warsaw", 52.2297, 21.0122, 3.1],
    ["Stockholm", 59.3293, 18.0686, 2.4],
    ["Oslo", 59.9139, 10.7522, 1.5],
    ["Helsinki", 60.1699, 24.9384, 1.3],
    ["Athens", 37.9838, 23.7275, 3.1],
    ["Lisbon", 38.7223, -9.1393, 2.9],
    ["Zurich", 47.3769, 8.5417, 1.4],
    ["Geneva", 46.2044, 6.1432, 1.2],
    ["Brussels", 50.8503, 4.3517, 2.1],
    ["Budapest", 47.4979, 19.0402, 3.0],
    ["Copenhagen", 55.6761, 12.5683, 2.0],
    ["Dublin", 53.3498, -6.2603, 1.9],
    ["Hamburg", 53.5511, 9.9937, 2.8],
    ["Munich", 48.1351, 11.5820, 2.9],
    ["Milan", 45.4642, 9.1900, 3.2],
    ["Naples", 40.8518, 14.2681, 3.1],
    ["Manchester", 53.4808, -2.2426, 2.8],
    ["Birmingham", 52.4862, -1.8904, 2.6],
    ["Glasgow", 55.8642, -4.2518, 1.7],
    ["Edinburgh", 55.9533, -3.1883, 1.0],
    ["Riyadh", 24.7136, 46.6753, 7.7],
    ["Dubai", 25.2048, 55.2708, 3.6],
    ["Doha", 25.2854, 51.5310, 2.4],
    ["Kuwait City", 29.3759, 47.9774, 3.4],
    ["Baghdad", 33.3152, 44.3661, 7.1],
    ["Jerusalem", 31.7683, 35.2137, 1.2],
    ["Tel Aviv", 32.0853, 34.7818, 4.3],
    ["Casablanca", 33.5731, -7.5898, 3.7],
    ["Algiers", 36.7538, 3.0588, 4.0],
    ["Tunis", 36.8065, 10.1815, 2.7],
    ["Accra", 5.6037, -0.1870, 5.0],
    ["Abuja", 9.0765, 7.3986, 3.6],
    ["Addis Ababa", 8.9806, 38.7578, 5.0],
    ["Khartoum", 15.5007, 32.5599, 5.3],
    ["Dar es Salaam", -6.7924, 39.2083, 7.0],
    ["Luanda", -8.8390, 13.2894, 8.3],
    ["Cape Town", -33.9249, 18.4241, 4.6],
    ["Pretoria", -25.7479, 28.2293, 2.9],
    ["Santiago", -33.4489, -70.6693, 7.0],
    ["Caracas", 10.4806, -66.9036, 4.0],
    ["Quito", -0.1807, -78.4678, 2.8],
    ["Guayaquil", -2.1700, -79.9224, 3.0],
    ["Panama City", 8.9824, -79.5199, 2.0],
    ["San Jose CR", 9.9281, -84.0907, 2.2],
    ["Havana", 23.1136, -82.3666, 2.1],
    ["Guatemala City", 14.6349, -90.5069, 3.1],
    ["Kathmandu", 27.7172, 85.3240, 3.0],
    ["Colombo", 6.9271, 79.8612, 2.3],
    ["Yangon", 16.8409, 96.1735, 5.1],
    ["Phnom Penh", 11.5564, 104.9282, 2.3],
    ["Ulaanbaatar", 47.8864, 106.9057, 1.6],
    ["Tashkent", 41.2995, 69.2401, 3.0],
    ["Almaty", 43.2220, 76.8512, 2.0],
    ["Astana", 51.1605, 71.4704, 1.3],
    ["Baku", 40.4093, 49.8671, 2.3],
    ["Yerevan", 40.1792, 44.4991, 1.1],
    ["Tbilisi", 41.7151, 44.8271, 1.2],
    ["Valencia", 39.4699, -0.3763, 1.7],
    ["Seville", 37.3891, -5.9845, 1.5],
    ["Porto", 41.1579, -8.6291, 1.7],
    ["Krakow", 50.0647, 19.9450, 1.4],
    ["Lodz", 51.7592, 19.4550, 1.0],
    ["Sofia", 42.6977, 23.3219, 1.7],
    ["Belgrade", 44.7866, 20.4489, 1.4],
    ["Zagreb", 45.8150, 15.9819, 1.1],
    ["Sarajevo", 43.8563, 18.4131, 0.8],
    ["Skopje", 41.9981, 21.4254, 0.7],

    ["Tallinn", 59.4370, 24.7536, 0.6],
    ["Riga", 56.9496, 24.1052, 0.8],
    ["Vilnius", 54.6872, 25.2797, 0.7],
    ["Bucharest", 44.4268, 26.1025, 2.1],
    ["Cluj-Napoca", 46.7712, 23.6236, 0.6],
    ["Thessaloniki", 40.6401, 22.9444, 1.0],
    ["Marseille", 43.2965, 5.3698, 1.6],
    ["Nice", 43.7102, 7.2620, 1.0],
    ["Toulouse", 43.6047, 1.4442, 1.4],
    ["Bordeaux", 44.8378, -0.5792, 1.3],

    ["Cologne", 50.9375, 6.9603, 3.6],
    ["Frankfurt", 50.1109, 8.6821, 2.3],
    ["Stuttgart", 48.7758, 9.1829, 2.8],
    ["Leipzig", 51.3397, 12.3731, 1.2],
    ["Dusseldorf", 51.2277, 6.7735, 1.6],
    ["Rotterdam", 51.9244, 4.4777, 1.0],
    ["Antwerp", 51.2194, 4.4025, 1.2],
    ["Gothenburg", 57.7089, 11.9746, 1.0],
    ["Malmo", 55.6050, 13.0038, 0.7],
    ["Reykjavik", 64.1466, -21.9426, 0.2],

    ["Anchorage", 61.2181, -149.9003, 0.4],
    ["Honolulu", 21.3069, -157.8583, 1.0],
    ["Portland", 45.5152, -122.6784, 2.5],
    ["Salt Lake City", 40.7608, -111.8910, 1.2],
    ["Kansas City", 39.0997, -94.5786, 2.1],
    ["St. Louis", 38.6270, -90.1994, 2.8],
    ["Cleveland", 41.4993, -81.6944, 2.0],
    ["Pittsburgh", 40.4406, -79.9959, 2.3],
    ["Tampa", 27.9506, -82.4572, 3.1],
    ["Orlando", 28.5383, -81.3792, 2.7],

    ["Monterrey", 25.6866, -100.3161, 5.3],
    ["Guadalajara", 20.6597, -103.3496, 5.3],
    ["Tijuana", 32.5149, -117.0382, 2.2],
    ["Medellin", 6.2442, -75.5812, 4.0],
    ["Recife", -8.0476, -34.8770, 4.1],
    ["Fortaleza", -3.7319, -38.5267, 4.0],
    ["Brasilia", -15.7939, -47.8828, 4.8],
    ["Porto Alegre", -30.0346, -51.2177, 4.2],
    ["Curitiba", -25.4284, -49.2733, 3.7],
    ["Montevideo", -34.9011, -56.1645, 1.8],

    ["Asuncion", -25.2637, -57.5759, 1.6],
    ["La Paz", -16.4897, -68.1193, 2.3],
    ["San Pedro Sula", 15.5041, -88.0250, 1.2],
    ["Antananarivo", -18.8792, 47.5079, 3.0],
    ["Kampala", 0.3476, 32.5825, 4.0],
    ["Lusaka", -15.3875, 28.3228, 3.1],
    ["Gaborone", -24.6282, 25.9231, 0.4],
    ["Windhoek", -22.5609, 17.0658, 0.4],
    ["Douala", 4.0511, 9.7679, 3.9],
    ["Yaounde", 3.8480, 11.5021, 3.6],

    ["Dakar", 14.7167, -17.4677, 3.4],
    ["Bamako", 12.6392, -8.0029, 3.0],
    ["Niamey", 13.5116, 2.1254, 1.3],
    ["Ouagadougou", 12.3714, -1.5197, 3.0],
    ["Monrovia", 6.3156, -10.8074, 1.5],
    ["Freetown", 8.4657, -13.2317, 1.4],
    ["Conakry", 9.6412, -13.5784, 2.1],
    ["Libreville", 0.4162, 9.4673, 0.8],
    ["Brazzaville", -4.2634, 15.2429, 2.2],
    ["Mogadishu", 2.0469, 45.3182, 2.4],

    ["Muscat", 23.5880, 58.3829, 1.6],
    ["Amman", 31.9454, 35.9284, 4.0],
    ["Beirut", 33.8938, 35.5018, 2.4],
    ["Damascus", 33.5138, 36.2765, 2.5],
    ["Tbilisi", 41.7151, 44.8271, 1.2],
    ["Bishkek", 42.8746, 74.5698, 1.1],
    ["Ashgabat", 37.9601, 58.3261, 1.0],
    ["Dushanbe", 38.5598, 68.7870, 1.2],
    ["Hanoi", 21.0278, 105.8342, 8.0],
    ["Surabaya", -7.2575, 112.7521, 6.8],

    ["Bandung", -6.9175, 107.6191, 3.5],
    ["Semarang", -6.9667, 110.4167, 1.8],
    ["Chiang Mai", 18.7883, 98.9853, 1.2],
    ["Cebu City", 10.3157, 123.8854, 3.2],
    ["Busan", 35.1796, 129.0756, 3.3],
    ["Sapporo", 43.0618, 141.3545, 1.9],
    ["Fukuoka", 33.5902, 130.4017, 2.6],
    ["Kaohsiung", 22.6273, 120.3014, 2.8],
    ["Taipei", 25.0330, 121.5654, 7.0],
    ["Perth", -31.9505, 115.8605, 2.2],
    ["Tucson", 32.2226, -110.9747, 1.1],
    ["Fresno", 36.7378, -119.7871, 1.2],
    ["Sacramento", 38.5816, -121.4944, 2.4],
    ["Raleigh", 35.7796, -78.6382, 1.5],
    ["Nashville", 36.1627, -86.7816, 2.1],
    ["Columbus", 39.9612, -82.9988, 2.1],
    ["Indianapolis", 39.7684, -86.1581, 2.1],
    ["Charlotte", 35.2271, -80.8431, 2.3],
    ["Austin", 30.2672, -97.7431, 2.3],
    ["Jacksonville", 30.3322, -81.6557, 1.6],
    ["Oklahoma City", 35.4676, -97.5164, 1.4],
    ["Louisville", 38.2527, -85.7585, 1.3],
    ["Memphis", 35.1495, -90.0490, 1.3],
    ["Milwaukee", 43.0389, -87.9065, 1.6],
    ["Richmond", 37.5407, -77.4360, 1.3],
    ["Buffalo", 42.8864, -78.8784, 1.1],
    ["Hartford", 41.7658, -72.6734, 1.2],
    ["Providence", 41.8240, -71.4128, 1.6],
    ["Virginia Beach", 36.8529, -75.9780, 1.8],
    ["Bristol", 51.4545, -2.5879, 1.1],
    ["Leeds", 53.8008, -1.5491, 1.9],
    ["Sheffield", 53.3811, -1.4701, 1.6],
    ["Newcastle", 54.9783, -1.6178, 1.2],
    ["Cardiff", 51.4816, -3.1791, 1.1],
    ["Nottingham", 52.9548, -1.1581, 1.2],
    ["Valletta", 35.8989, 14.5146, 0.5],
    ["Turin", 45.0703, 7.6869, 1.7],
    ["Bologna", 44.4949, 11.3426, 1.0],
    ["Florence", 43.7696, 11.2558, 1.0],
    ["Lyon", 45.7640, 4.8357, 2.3],
    ["Nantes", 47.2184, -1.5536, 1.0],
    ["Lille", 50.6292, 3.0573, 1.2],
    ["Montpellier", 43.6108, 3.8767, 0.9],
    ["Strasbourg", 48.5734, 7.7521, 0.8],
    ["Dresden", 51.0504, 13.7373, 0.8],
    ["Bremen", 53.0793, 8.8017, 0.9],
    ["Hanover", 52.3759, 9.7320, 1.1],
    ["Nuremberg", 49.4521, 11.0767, 1.2],
    ["Graz", 47.0707, 15.4395, 0.7],
    ["Salzburg", 47.8095, 13.0550, 0.4],
    ["Basel", 47.5596, 7.5886, 0.9],
    ["Lausanne", 46.5197, 6.6323, 0.4],
    ["Innsbruck", 47.2692, 11.4041, 0.3],
    ["Malaga", 36.7213, -4.4214, 1.0],
    ["Bilbao", 43.2630, -2.9350, 1.0],
    ["Zaragoza", 41.6488, -0.8891, 0.9],
    ["Palermo", 38.1157, 13.3615, 1.2],
    ["Catania", 37.5079, 15.0830, 1.1],
    ["Thessaloniki", 40.6401, 22.9444, 1.0],
    ["Brasov", 45.6579, 25.6012, 0.6],
    ["Timisoara", 45.7489, 21.2087, 0.5],
    ["Plovdiv", 42.1354, 24.7453, 0.6],
    ["Ljubljana", 46.0569, 14.5058, 0.4],
    ["Luxembourg City", 49.6116, 6.1319, 0.2],
    ["Reims", 49.2583, 4.0317, 0.6],
    ["Grenoble", 45.1885, 5.7245, 0.7],
    ["Bergen", 60.3913, 5.3221, 0.4],
    ["Aarhus", 56.1629, 10.2039, 0.4],
    ["Tampere", 61.4978, 23.7610, 0.4],
    ["Gdansk", 54.3520, 18.6466, 1.0],
    ["Poznan", 52.4064, 16.9252, 1.0],
    ["Wroclaw", 51.1079, 17.0385, 1.1],
    ["Brno", 49.1951, 16.6068, 0.6],
    ["Lviv", 49.8397, 24.0297, 0.7],
    ["Odessa", 46.4825, 30.7233, 1.0],
    ["Krasnodar", 45.0355, 38.9753, 1.0],
    ["Samara", 53.1959, 50.1002, 1.2],
    ["Perm", 58.0105, 56.2502, 1.0],
    ["Ufa", 54.7388, 55.9721, 1.1],
    ["Volgograd", 48.7080, 44.5133, 1.0],
    ["Kazan", 55.8304, 49.0661, 1.3],
    ["Yekaterinburg", 56.8389, 60.6057, 1.6],
    ["Chelyabinsk", 55.1644, 61.4368, 1.2],
    ["Omsk", 54.9885, 73.3242, 1.1],
    ["Novosibirsk", 55.0084, 82.9357, 1.6],
    ["Havana", 23.1136, -82.3666, 2.1],
    ["Santo Domingo", 18.4861, -69.9312, 3.4],
    ["Port-au-Prince", 18.5944, -72.3074, 2.6],
    ["San Juan", 18.4655, -66.1057, 2.4],
    ["Kingston", 17.9712, -76.7936, 1.2],
    ["Port of Spain", 10.6549, -61.5019, 0.6],
    ["Paramaribo", 5.8520, -55.2038, 0.3],
    ["Georgetown", 6.8013, -58.1551, 0.3],
    ["Maracaibo", 10.6545, -71.6533, 2.0],
    ["Santa Cruz", -17.7833, -63.1821, 2.0],
    ["Arequipa", -16.4090, -71.5375, 1.1],
    ["Trujillo", -8.1150, -79.0288, 1.0],
    ["Valparaiso", -33.0472, -71.6127, 1.0],
    ["Cordoba AR", -31.4201, -64.1888, 1.6],
    ["Rosario", -32.9442, -60.6505, 1.4],
    ["Goiania", -16.6864, -49.2643, 1.5],
    ["Belem", -1.4558, -48.4902, 1.5],
    ["Manaus", -3.1190, -60.0217, 2.2],
    ["Campinas", -22.9099, -47.0626, 1.3],
    ["Santo Andre", -23.6639, -46.5383, 0.7],
    ["Guatemala City", 14.6349, -90.5069, 3.1],
    ["San Salvador", 13.6929, -89.2182, 2.2],
    ["Tegucigalpa", 14.0723, -87.1921, 1.5],
    ["Managua", 12.1149, -86.2362, 1.5],
    ["Cartagena", 10.3910, -75.4794, 1.1],
    ["Cali", 3.4516, -76.5320, 2.4],
    ["Barranquilla", 10.9685, -74.7813, 1.3],
    ["Guadalajara MX", 20.6597, -103.3496, 5.3],
    ["San Luis Potosi", 22.1565, -100.9855, 1.3],
    ["Puebla", 19.0414, -98.2063, 3.2],
    ["Queretaro", 20.5888, -100.3899, 1.4],
    ["Merida MX", 20.9674, -89.5926, 1.2],
    ["Cancun", 21.1619, -86.8515, 1.0],

    /* -------- ASIA -------- */

    ["Kanpur", 26.4499, 80.3319, 3.2],
    ["Lucknow", 26.8467, 80.9462, 3.6],
    ["Surat", 21.1702, 72.8311, 6.8],
    ["Jaipur", 26.9124, 75.7873, 3.1],
    ["Nagpur", 21.1458, 79.0882, 2.9],
    ["Patna", 25.5941, 85.1376, 2.5],
    ["Indore", 22.7196, 75.8577, 3.0],
    ["Bhopal", 23.2599, 77.4126, 2.4],
    ["Coimbatore", 11.0168, 76.9558, 2.2],
    ["Visakhapatnam", 17.6868, 83.2185, 2.1],
    ["Varanasi", 25.3176, 82.9739, 1.6],
    ["Lahore", 31.5204, 74.3587, 13.0],
    ["Faisalabad", 31.4504, 73.1350, 3.2],
    ["Multan", 30.1575, 71.5249, 2.1],
    ["Rawalpindi", 33.5651, 73.0169, 2.1],
    ["Chittagong", 22.3569, 91.7832, 5.2],
    ["Khulna", 22.8456, 89.5403, 1.5],
    ["Guangxi Nanning", 22.8170, 108.3669, 3.5],
    ["Wuhan", 30.5928, 114.3055, 10.9],
    ["Chengdu", 30.5728, 104.0668, 16.0],
    ["Xi'an", 34.3416, 108.9398, 12.0],
    ["Suzhou", 31.2989, 120.5853, 12.7],
    ["Hangzhou", 30.2741, 120.1551, 11.9],
    ["Nanjing", 32.0603, 118.7969, 9.3],
    ["Yokohama", 35.4437, 139.6380, 3.7],

    /* -------- OCEANIA -------- */

    ["Adelaide", -34.9285, 138.6007, 1.4],
    ["Canberra", -35.2809, 149.1300, 0.5],
    ["Hobart", -42.8821, 147.3272, 0.3],
    ["Darwin", -12.4634, 130.8456, 0.2],
    ["Auckland", -36.8485, 174.7633, 1.7],
    ["Wellington", -41.2865, 174.7762, 0.4],
    ["Christchurch", -43.5321, 172.6362, 0.4],
    ["Port Moresby", -9.4438, 147.1803, 0.4],
    ["Suva", -18.1248, 178.4501, 0.2],
    ["Honiara", -9.4456, 159.9729, 0.1],
    ["Noumea", -22.2758, 166.4580, 0.2],
    ["Apia", -13.8333, -171.7667, 0.1],
    ["Nuku'alofa", -21.1394, -175.2047, 0.1],
    ["Tarawa", 1.4518, 172.9717, 0.1],
    ["Majuro", 7.1164, 171.1858, 0.05]


];


  const citySize = 0.03;

  const positions = [];
  const colors = [];

  const listElement = document.getElementById("list");

  cities.forEach(([name, lat, lon, pop]) => {

    const phi = (90 - lat) * (Math.PI / 180);
    const theta = (lon + 180) * (Math.PI / 180);

    const x = -radius * Math.sin(phi) * Math.cos(theta);
    const z =  radius * Math.sin(phi) * Math.sin(theta);
    const y =  radius * Math.cos(phi);

    positions.push(x, y, z);

    colors.push(1.0, 0.6, 0.1);

    const li = document.createElement("li");
    li.textContent = `${name} — ${pop}M`;
    listElement.appendChild(li);
  });

  const cityGeo = new THREE.BufferGeometry();
  cityGeo.setAttribute("position", new THREE.Float32BufferAttribute(positions,3));
  cityGeo.setAttribute("color", new THREE.Float32BufferAttribute(colors,3));

  const cityMat = new THREE.PointsMaterial({
    size: citySize,
    vertexColors: true,
    transparent: true,
    depthWrite: false
  });

  const cityPoints = new THREE.Points(cityGeo, cityMat);
  scene.add(cityPoints);


  /* ===============================
     INTERACTION
  =============================== */

  let dragging=false, prevX=0, prevY=0;

  window.addEventListener("mousedown",e=>{dragging=true;prevX=e.clientX;prevY=e.clientY;});
  window.addEventListener("mouseup",()=>dragging=false);
  window.addEventListener("mousemove",e=>{
    if(!dragging) return;
    scene.rotation.y+=(e.clientX-prevX)*0.005;
    scene.rotation.x+=(e.clientY-prevY)*0.005;
    prevX=e.clientX; prevY=e.clientY;
  });

  function animate(){
    requestAnimationFrame(animate);
    scene.rotation.y+=0.0008;
    renderer.render(scene,camera);
  }

  animate();
}

window.addEventListener("resize",()=>{
  camera.aspect=window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});
</script>
</body>
</html>